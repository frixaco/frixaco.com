<!doctype html>
<html>
  <head>
    <title>frixa</title>
    <style>
      * {
        min-width: 0;
      }
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }
      *:not(dialog) {
        margin: 0;
      }
      @media (prefers-reduced-motion: no-preference) {
        html {
          interpolate-size: allow-keywords;
        }
      }
      img,
      picture,
      video,
      canvas,
      svg {
        display: block;
        max-width: 100%;
      }
      input,
      button,
      textarea,
      select {
        font: inherit;
      }
      p,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        overflow-wrap: break-word;
      }
      p {
        text-wrap: pretty;
      }
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        text-wrap: balance;
      }
      :root {
        --bg: #fbebd9;
        --fg: #321609;
      }
      html {
        overscroll-behavior: none;
      }
      body {
        line-height: 1.5;
        -webkit-font-smoothing: antialiased;
        background-color: var(--bg);
        color: var(--fg);
        font-family: monospace;
        max-width: 800px;
        min-height: 100vh;
        padding: 0 24px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 24px;
      }
      #header,
      #footer {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 24px 0;
        z-index: 1;
        background-color: var(--bg);
      }
      #header {
        position: sticky;
        top: 0;
      }
      #footer {
        position: sticky;
        bottom: 0;
      }
      #wrapper {
        isolation: isolate;
        flex: 1;
      }
      #header #home-btn {
        font-weight: bold;
      }
      #header a,
      #footer span {
        all: unset;
        padding: 0 24px;
        text-transform: uppercase;
        background-color: var(--bg);
        border: 2px solid var(--fg);
      }
      #header a {
        cursor: pointer;
        transition:
          color 0.2s,
          background-color 0.2s;
      }
      #header a:hover {
        color: var(--bg);
        background-color: var(--fg);
      }
      .long-ass-line {
        height: 2px;
        background-color: var(--fg);
        position: absolute;
        right: 0;
        left: 0;
        z-index: -1;
      }
      .square {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        right: 0;
        width: 24px;
        height: 24px;
        border: 2px solid var(--fg);
        background-color: var(--bg);
        transition:
          background-color 0.2s,
          border-radius 0.3s;
      }
      .square:hover {
        background-color: var(--fg);
        border-radius: 50%;
      }
      #footer .square {
        right: auto;
        left: 0;
      }
      #footer span {
        position: absolute;
        right: 0;
      }
      #wrapper h1,
      #wrapper h2 {
        padding: 0.3em 0;
      }
      #wrapper h3,
      #wrapper h4,
      #wrapper h5,
      #wrapper h6 {
        padding: 0.25em 0;
      }
      #wrapper p {
        padding-bottom: 0.5em;
      }
      #wrapper ul,
      #wrapper ol {
        padding: 0 0 0.5em 1.5em;
      }
      #wrapper li {
        padding-bottom: 0.25em;
      }
      #wrapper a {
        color: var(--fg);
        text-decoration: underline;
        text-underline-offset: 2px;
      }
      #wrapper a:hover {
        background-color: var(--fg);
        color: var(--bg);
        text-decoration: none;
      }
      #wrapper hr {
        border: none;
        border-bottom: 1px dashed var(--fg);
        opacity: 0.3;
        margin: 1em 0;
      }
      #wrapper code,
      #wrapper pre {
        background-color: var(--fg);
        color: var(--bg);
      }
      #wrapper code {
        padding: 0.1em 0.3em;
      }
      #wrapper pre {
        padding: 1em;
        overflow-x: auto;
      }
      #wrapper pre code {
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="header">
      <a id="home-btn" href="/">RUSTAM</a>
      <a id="blog-btn" href="/blog">blog</a>
      <a id="more-btn" href="/more">more</a>

      <div class="long-ass-line"></div>

      <div class="square"></div>
    </div>

    <div id="wrapper">
      <!--CONTENT-->
    </div>

    <div id="footer">
      <div class="square"></div>

      <div class="long-ass-line"></div>

      <span id="last-updated">...</span>
    </div>

    <script type="module">
      const wrapper = document.getElementById("wrapper");

      let pathname = window.location.pathname;
      let pages = {
        "/": undefined,
        "/blog": undefined,
        "/more": undefined,
      };
      // Server injects initial content into #wrapper, use it directly
      pages[pathname] = wrapper.innerHTML;

      // Prefetch other pages
      for (const [path, val] of Object.entries(pages)) {
        if (val !== undefined) continue;
        const mdPath = path === "/" ? "/md/home" : "/md" + path;
        fetch(mdPath)
          .then((d) => d.text())
          .then((html) => {
            pages[path] = html;
          });
      }

      function navigate(path) {
        if (pages[path]) {
          wrapper.innerHTML = pages[path];
          history.pushState(null, "", path);
        } else {
          fetch("/md" + path)
            .then((d) => d.text())
            .then((html) => {
              pages[path] = html;
              wrapper.innerHTML = html;
              history.pushState(null, "", path);
            });
        }
      }

      document.getElementById("header").addEventListener("click", (e) => {
        const a = e.target.closest("a");
        if (!a) return;
        e.preventDefault();
        navigate(a.getAttribute("href"));
      });

      fetch(
        "https://api.github.com/repos/frixaco/frixaco.com/commits?per_page=1",
      )
        .then((r) => r.json())
        .then(([commit]) => {
          const date = new Date(commit.commit.committer.date);
          document.getElementById("last-updated").textContent =
            "updated " +
            date.toLocaleDateString("en-US", {
              year: "numeric",
              month: "short",
              day: "numeric",
            });
        })
        .catch(() => {
          document.getElementById("last-updated").textContent = "frixaco.com";
        });

      wrapper.addEventListener("click", (e) => {
        const a = e.target.closest("a");
        if (!a || !a.getAttribute("href").startsWith("/blog/")) return;
        e.preventDefault();
        navigate(a.getAttribute("href"));
      });
    </script>
  </body>
</html>
